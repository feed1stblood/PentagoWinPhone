using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using PentagoWeb.Model.Board;
using System.Collections.Generic;
using System.Linq;

namespace PentagoWeb.Model.AI
{
    public class PentagoNodeEva2 : PentagoNode
    {
        readonly int?[,] RotationInfo = {{0,0,null,null,0},
{0,null,0,null,0},
{0,null,null,0,0},
{0,0,null,null,0},
{0,null,0,null,0},
{0,null,0,0,0},
{0,0,null,null,0},
{null,null,0,0,0},
{null,null,0,0,0},
{0,0,0,null,0},
{null,null,0,0,0},
{null,0,0,null,0},
{0,0,null,null,0},
{0,null,0,null,0},
{0,0,null,0,0},
{0,0,null,null,0},
{0,null,0,null,0},
{0,null,null,0,0},
{0,0,null,null,0},
{null,null,0,0,0},
{null,null,0,0,0},
{null,0,0,null,0},
{null,null,0,0,0},
{null,0,0,0,0},
{0,null,0,null,0},
{0,null,0,null,0},
{null,0,null,0,0},
{null,0,null,0,0},
{null,0,null,0,0},
{null,0,null,0,0},
{null,0,null,0,0},
{null,0,null,0,0},
{0,null,null,1,1},
{0,null,0,1,1},
{null,null,0,1,1},
{null,null,0,1,1},
{null,null,0,1,1},
{0,0,null,1,1},
{0,null,null,1,1},
{null,null,0,1,1},
{null,null,0,1,1},
{null,null,0,1,1},
{null,0,0,1,1},
{null,0,null,1,1},
{null,0,null,1,1},
{null,0,null,1,1},
{null,0,null,1,1},
{null,0,null,1,1},
{null,0,null,1,1},
{0,null,null,2,2},
{0,null,0,2,2},
{null,null,0,2,2},
{null,null,0,2,2},
{null,null,0,2,2},
{0,0,null,2,2},
{0,null,null,2,2},
{null,null,0,2,2},
{null,null,0,2,2},
{null,null,0,2,2},
{null,0,0,2,2},
{null,0,null,2,2},
{null,0,null,2,2},
{null,0,null,2,2},
{null,0,null,2,2},
{null,0,null,2,2},
{null,0,null,2,2},
{0,null,null,-1,1},
{0,null,0,-1,1},
{null,null,0,-1,1},
{null,null,0,-1,1},
{null,null,0,-1,1},
{0,0,null,-1,1},
{0,null,null,-1,1},
{null,null,0,-1,1},
{null,null,0,-1,1},
{null,null,0,-1,1},
{null,0,0,-1,1},
{null,0,null,-1,1},
{null,0,null,-1,1},
{null,0,null,-1,1},
{null,0,null,-1,1},
{null,0,null,-1,1},
{null,0,null,-1,1},
{0,null,1,null,1},
{0,null,1,null,1},
{0,null,1,0,1},
{null,null,1,0,1},
{null,null,1,0,1},
{0,0,1,null,1},
{null,null,1,0,1},
{null,0,1,null,1},
{0,null,1,null,1},
{0,null,1,null,1},
{null,null,1,0,1},
{null,null,1,0,1},
{null,0,1,null,1},
{null,null,1,0,1},
{null,0,1,0,1},
{0,null,1,null,1},
{0,null,1,null,1},
{0,null,1,1,2},
{null,null,1,1,2},
{null,null,1,1,2},
{null,null,1,1,2},
{null,null,1,1,2},
{null,null,1,1,2},
{null,null,1,1,2},
{null,0,1,1,2},
{0,null,1,2,3},
{null,null,1,2,3},
{null,null,1,2,3},
{null,null,1,2,3},
{null,null,1,2,3},
{null,null,1,2,3},
{null,null,1,2,3},
{null,0,1,2,3},
{0,null,1,-1,2},
{null,null,1,-1,2},
{null,null,1,-1,2},
{null,null,1,-1,2},
{null,null,1,-1,2},
{null,null,1,-1,2},
{null,null,1,-1,2},
{null,0,1,-1,2},
{0,null,2,null,2},
{0,null,2,null,2},
{0,null,2,0,2},
{null,null,2,0,2},
{null,null,2,0,2},
{0,0,2,null,2},
{null,null,2,0,2},
{null,0,2,null,2},
{0,null,2,null,2},
{0,null,2,null,2},
{null,null,2,0,2},
{null,null,2,0,2},
{null,0,2,null,2},
{null,null,2,0,2},
{null,0,2,0,2},
{0,null,2,null,2},
{0,null,2,null,2},
{0,null,2,1,3},
{null,null,2,1,3},
{null,null,2,1,3},
{null,null,2,1,3},
{null,null,2,1,3},
{null,null,2,1,3},
{null,null,2,1,3},
{null,0,2,1,3},
{0,null,2,2,4},
{null,null,2,2,4},
{null,null,2,2,4},
{null,null,2,2,4},
{null,null,2,2,4},
{null,null,2,2,4},
{null,null,2,2,4},
{null,0,2,2,4},
{0,null,2,-1,3},
{null,null,2,-1,3},
{null,null,2,-1,3},
{null,null,2,-1,3},
{null,null,2,-1,3},
{null,null,2,-1,3},
{null,null,2,-1,3},
{null,0,2,-1,3},
{0,null,-1,null,1},
{0,null,-1,null,1},
{0,null,-1,0,1},
{null,null,-1,0,1},
{null,null,-1,0,1},
{0,0,-1,null,1},
{null,null,-1,0,1},
{null,0,-1,null,1},
{0,null,-1,null,1},
{0,null,-1,null,1},
{null,null,-1,0,1},
{null,null,-1,0,1},
{null,0,-1,null,1},
{null,null,-1,0,1},
{null,0,-1,0,1},
{0,null,-1,null,1},
{0,null,-1,null,1},
{0,null,-1,1,2},
{null,null,-1,1,2},
{null,null,-1,1,2},
{null,null,-1,1,2},
{null,null,-1,1,2},
{null,null,-1,1,2},
{null,null,-1,1,2},
{null,0,-1,1,2},
{0,null,-1,2,3},
{null,null,-1,2,3},
{null,null,-1,2,3},
{null,null,-1,2,3},
{null,null,-1,2,3},
{null,null,-1,2,3},
{null,null,-1,2,3},
{null,0,-1,2,3},
{0,null,-1,-1,2},
{null,null,-1,-1,2},
{null,null,-1,-1,2},
{null,null,-1,-1,2},
{null,null,-1,-1,2},
{null,null,-1,-1,2},
{null,null,-1,-1,2},
{null,0,-1,-1,2},
{0,1,null,null,1},
{0,1,null,null,1},
{0,1,null,null,1},
{0,1,0,null,1},
{null,1,0,null,1},
{0,1,null,null,1},
{0,1,null,0,1},
{0,1,null,null,1},
{0,1,null,null,1},
{null,1,0,null,1},
{null,1,0,0,1},
{null,1,null,0,1},
{null,1,null,0,1},
{null,1,null,0,1},
{null,1,null,0,1},
{null,1,null,0,1},
{null,1,null,0,1},
{0,1,null,1,2},
{null,1,0,1,2},
{null,1,null,1,2},
{null,1,null,1,2},
{null,1,null,1,2},
{null,1,null,1,2},
{null,1,null,1,2},
{null,1,null,1,2},
{0,1,null,2,3},
{null,1,0,2,3},
{null,1,null,2,3},
{null,1,null,2,3},
{null,1,null,2,3},
{null,1,null,2,3},
{null,1,null,2,3},
{null,1,null,2,3},
{0,1,null,-1,2},
{null,1,0,-1,2},
{null,1,null,-1,2},
{null,1,null,-1,2},
{null,1,null,-1,2},
{null,1,null,-1,2},
{null,1,null,-1,2},
{null,1,null,-1,2},
{0,1,1,null,2},
{null,1,1,null,2},
{null,1,1,null,2},
{null,1,1,0,2},
{null,1,1,1,3},
{null,1,1,2,4},
{null,1,1,-1,3},
{0,1,2,null,3},
{null,1,2,null,3},
{null,1,2,null,3},
{null,1,2,0,3},
{null,1,2,1,4},
{null,1,2,2,5},
{null,1,2,-1,4},
{0,1,-1,null,2},
{null,1,-1,null,2},
{null,1,-1,null,2},
{null,1,-1,0,2},
{null,1,-1,1,3},
{null,1,-1,2,4},
{null,1,-1,-1,3},
{0,2,null,null,2},
{0,2,null,null,2},
{0,2,null,null,2},
{0,2,0,null,2},
{null,2,0,null,2},
{0,2,null,null,2},
{0,2,null,0,2},
{0,2,null,null,2},
{0,2,null,null,2},
{null,2,0,null,2},
{null,2,0,0,2},
{null,2,null,0,2},
{null,2,null,0,2},
{null,2,null,0,2},
{null,2,null,0,2},
{null,2,null,0,2},
{null,2,null,0,2},
{0,2,null,1,3},
{null,2,0,1,3},
{null,2,null,1,3},
{null,2,null,1,3},
{null,2,null,1,3},
{null,2,null,1,3},
{null,2,null,1,3},
{null,2,null,1,3},
{0,2,null,2,4},
{null,2,0,2,4},
{null,2,null,2,4},
{null,2,null,2,4},
{null,2,null,2,4},
{null,2,null,2,4},
{null,2,null,2,4},
{null,2,null,2,4},
{0,2,null,-1,3},
{null,2,0,-1,3},
{null,2,null,-1,3},
{null,2,null,-1,3},
{null,2,null,-1,3},
{null,2,null,-1,3},
{null,2,null,-1,3},
{null,2,null,-1,3},
{0,2,1,null,3},
{null,2,1,null,3},
{null,2,1,null,3},
{null,2,1,0,3},
{null,2,1,1,4},
{null,2,1,2,5},
{null,2,1,-1,4},
{0,2,2,null,4},
{null,2,2,null,4},
{null,2,2,null,4},
{null,2,2,0,4},
{null,2,2,1,5},
{null,2,2,2,6},
{null,2,2,-1,5},
{0,2,-1,null,3},
{null,2,-1,null,3},
{null,2,-1,null,3},
{null,2,-1,0,3},
{null,2,-1,1,4},
{null,2,-1,2,5},
{null,2,-1,-1,4},
{0,-1,null,null,1},
{0,-1,null,null,1},
{0,-1,null,null,1},
{0,-1,0,null,1},
{null,-1,0,null,1},
{0,-1,null,null,1},
{0,-1,null,0,1},
{0,-1,null,null,1},
{0,-1,null,null,1},
{null,-1,0,null,1},
{null,-1,0,0,1},
{null,-1,null,0,1},
{null,-1,null,0,1},
{null,-1,null,0,1},
{null,-1,null,0,1},
{null,-1,null,0,1},
{null,-1,null,0,1},
{0,-1,null,1,2},
{null,-1,0,1,2},
{null,-1,null,1,2},
{null,-1,null,1,2},
{null,-1,null,1,2},
{null,-1,null,1,2},
{null,-1,null,1,2},
{null,-1,null,1,2},
{0,-1,null,2,3},
{null,-1,0,2,3},
{null,-1,null,2,3},
{null,-1,null,2,3},
{null,-1,null,2,3},
{null,-1,null,2,3},
{null,-1,null,2,3},
{null,-1,null,2,3},
{0,-1,null,-1,2},
{null,-1,0,-1,2},
{null,-1,null,-1,2},
{null,-1,null,-1,2},
{null,-1,null,-1,2},
{null,-1,null,-1,2},
{null,-1,null,-1,2},
{null,-1,null,-1,2},
{0,-1,1,null,2},
{null,-1,1,null,2},
{null,-1,1,null,2},
{null,-1,1,0,2},
{null,-1,1,1,3},
{null,-1,1,2,4},
{null,-1,1,-1,3},
{0,-1,2,null,3},
{null,-1,2,null,3},
{null,-1,2,null,3},
{null,-1,2,0,3},
{null,-1,2,1,4},
{null,-1,2,2,5},
{null,-1,2,-1,4},
{0,-1,-1,null,2},
{null,-1,-1,null,2},
{null,-1,-1,null,2},
{null,-1,-1,0,2},
{null,-1,-1,1,3},
{null,-1,-1,2,4},
{null,-1,-1,-1,3},
{1,0,null,null,1},
{1,null,0,null,1},
{1,null,null,0,1},
{1,0,null,null,1},
{1,null,0,null,1},
{1,null,0,0,1},
{1,0,null,null,1},
{1,0,0,null,1},
{1,0,null,null,1},
{1,null,0,null,1},
{1,0,null,0,1},
{1,0,null,null,1},
{1,null,0,null,1},
{1,null,null,0,1},
{1,0,null,null,1},
{1,null,0,null,1},
{1,null,0,null,1},
{1,null,null,1,2},
{1,null,0,1,2},
{1,0,null,1,2},
{1,null,null,1,2},
{1,null,null,2,3},
{1,null,0,2,3},
{1,0,null,2,3},
{1,null,null,2,3},
{1,null,null,-1,2},
{1,null,0,-1,2},
{1,0,null,-1,2},
{1,null,null,-1,2},
{1,null,1,null,2},
{1,null,1,null,2},
{1,null,1,0,2},
{1,0,1,null,2},
{1,null,1,null,2},
{1,null,1,null,2},
{1,null,1,null,2},
{1,null,1,null,2},
{1,null,1,1,3},
{1,null,1,2,4},
{1,null,1,-1,3},
{1,null,2,null,3},
{1,null,2,null,3},
{1,null,2,0,3},
{1,0,2,null,3},
{1,null,2,null,3},
{1,null,2,null,3},
{1,null,2,null,3},
{1,null,2,null,3},
{1,null,2,1,4},
{1,null,2,2,5},
{1,null,2,-1,4},
{1,null,-1,null,2},
{1,null,-1,null,2},
{1,null,-1,0,2},
{1,0,-1,null,2},
{1,null,-1,null,2},
{1,null,-1,null,2},
{1,null,-1,null,2},
{1,null,-1,null,2},
{1,null,-1,1,3},
{1,null,-1,2,4},
{1,null,-1,-1,3},
{1,1,null,null,2},
{1,1,null,null,2},
{1,1,null,null,2},
{1,1,0,null,2},
{1,1,null,null,2},
{1,1,null,0,2},
{1,1,null,null,2},
{1,1,null,null,2},
{1,1,null,1,3},
{1,1,null,2,4},
{1,1,null,-1,3},
{1,1,1,null,3},
{1,1,2,null,4},
{1,1,-1,null,3},
{1,2,null,null,3},
{1,2,null,null,3},
{1,2,null,null,3},
{1,2,0,null,3},
{1,2,null,null,3},
{1,2,null,0,3},
{1,2,null,null,3},
{1,2,null,null,3},
{1,2,null,1,4},
{1,2,null,2,5},
{1,2,null,-1,4},
{1,2,1,null,4},
{1,2,2,null,5},
{1,2,-1,null,4},
{1,-1,null,null,2},
{1,-1,null,null,2},
{1,-1,null,null,2},
{1,-1,0,null,2},
{1,-1,null,null,2},
{1,-1,null,0,2},
{1,-1,null,null,2},
{1,-1,null,null,2},
{1,-1,null,1,3},
{1,-1,null,2,4},
{1,-1,null,-1,3},
{1,-1,1,null,3},
{1,-1,2,null,4},
{1,-1,-1,null,3},
{2,0,null,null,2},
{2,null,0,null,2},
{2,null,null,0,2},
{2,0,null,null,2},
{2,null,0,null,2},
{2,null,0,0,2},
{2,0,null,null,2},
{2,0,0,null,2},
{2,0,null,null,2},
{2,null,0,null,2},
{2,0,null,0,2},
{2,0,null,null,2},
{2,null,0,null,2},
{2,null,null,0,2},
{2,0,null,null,2},
{2,null,0,null,2},
{2,null,0,null,2},
{2,null,null,1,3},
{2,null,0,1,3},
{2,0,null,1,3},
{2,null,null,1,3},
{2,null,null,2,4},
{2,null,0,2,4},
{2,0,null,2,4},
{2,null,null,2,4},
{2,null,null,-1,3},
{2,null,0,-1,3},
{2,0,null,-1,3},
{2,null,null,-1,3},
{2,null,1,null,3},
{2,null,1,null,3},
{2,null,1,0,3},
{2,0,1,null,3},
{2,null,1,null,3},
{2,null,1,null,3},
{2,null,1,null,3},
{2,null,1,null,3},
{2,null,1,1,4},
{2,null,1,2,5},
{2,null,1,-1,4},
{2,null,2,null,4},
{2,null,2,null,4},
{2,null,2,0,4},
{2,0,2,null,4},
{2,null,2,null,4},
{2,null,2,null,4},
{2,null,2,null,4},
{2,null,2,null,4},
{2,null,2,1,5},
{2,null,2,2,6},
{2,null,2,-1,5},
{2,null,-1,null,3},
{2,null,-1,null,3},
{2,null,-1,0,3},
{2,0,-1,null,3},
{2,null,-1,null,3},
{2,null,-1,null,3},
{2,null,-1,null,3},
{2,null,-1,null,3},
{2,null,-1,1,4},
{2,null,-1,2,5},
{2,null,-1,-1,4},
{2,1,null,null,3},
{2,1,null,null,3},
{2,1,null,null,3},
{2,1,0,null,3},
{2,1,null,null,3},
{2,1,null,0,3},
{2,1,null,null,3},
{2,1,null,null,3},
{2,1,null,1,4},
{2,1,null,2,5},
{2,1,null,-1,4},
{2,1,1,null,4},
{2,1,2,null,5},
{2,1,-1,null,4},
{2,2,null,null,4},
{2,2,null,null,4},
{2,2,null,null,4},
{2,2,0,null,4},
{2,2,null,null,4},
{2,2,null,0,4},
{2,2,null,null,4},
{2,2,null,null,4},
{2,2,null,1,5},
{2,2,null,2,6},
{2,2,null,-1,5},
{2,2,1,null,5},
{2,2,2,null,6},
{2,2,-1,null,5},
{2,-1,null,null,3},
{2,-1,null,null,3},
{2,-1,null,null,3},
{2,-1,0,null,3},
{2,-1,null,null,3},
{2,-1,null,0,3},
{2,-1,null,null,3},
{2,-1,null,null,3},
{2,-1,null,1,4},
{2,-1,null,2,5},
{2,-1,null,-1,4},
{2,-1,1,null,4},
{2,-1,2,null,5},
{2,-1,-1,null,4},
{-1,0,null,null,1},
{-1,null,0,null,1},
{-1,null,null,0,1},
{-1,0,null,null,1},
{-1,null,0,null,1},
{-1,null,0,0,1},
{-1,0,null,null,1},
{-1,0,0,null,1},
{-1,0,null,null,1},
{-1,null,0,null,1},
{-1,0,null,0,1},
{-1,0,null,null,1},
{-1,null,0,null,1},
{-1,null,null,0,1},
{-1,0,null,null,1},
{-1,null,0,null,1},
{-1,null,0,null,1},
{-1,null,null,1,2},
{-1,null,0,1,2},
{-1,0,null,1,2},
{-1,null,null,1,2},
{-1,null,null,2,3},
{-1,null,0,2,3},
{-1,0,null,2,3},
{-1,null,null,2,3},
{-1,null,null,-1,2},
{-1,null,0,-1,2},
{-1,0,null,-1,2},
{-1,null,null,-1,2},
{-1,null,1,null,2},
{-1,null,1,null,2},
{-1,null,1,0,2},
{-1,0,1,null,2},
{-1,null,1,null,2},
{-1,null,1,null,2},
{-1,null,1,null,2},
{-1,null,1,null,2},
{-1,null,1,1,3},
{-1,null,1,2,4},
{-1,null,1,-1,3},
{-1,null,2,null,3},
{-1,null,2,null,3},
{-1,null,2,0,3},
{-1,0,2,null,3},
{-1,null,2,null,3},
{-1,null,2,null,3},
{-1,null,2,null,3},
{-1,null,2,null,3},
{-1,null,2,1,4},
{-1,null,2,2,5},
{-1,null,2,-1,4},
{-1,null,-1,null,2},
{-1,null,-1,null,2},
{-1,null,-1,0,2},
{-1,0,-1,null,2},
{-1,null,-1,null,2},
{-1,null,-1,null,2},
{-1,null,-1,null,2},
{-1,null,-1,null,2},
{-1,null,-1,1,3},
{-1,null,-1,2,4},
{-1,null,-1,-1,3},
{-1,1,null,null,2},
{-1,1,null,null,2},
{-1,1,null,null,2},
{-1,1,0,null,2},
{-1,1,null,null,2},
{-1,1,null,0,2},
{-1,1,null,null,2},
{-1,1,null,null,2},
{-1,1,null,1,3},
{-1,1,null,2,4},
{-1,1,null,-1,3},
{-1,1,1,null,3},
{-1,1,2,null,4},
{-1,1,-1,null,3},
{-1,2,null,null,3},
{-1,2,null,null,3},
{-1,2,null,null,3},
{-1,2,0,null,3},
{-1,2,null,null,3},
{-1,2,null,0,3},
{-1,2,null,null,3},
{-1,2,null,null,3},
{-1,2,null,1,4},
{-1,2,null,2,5},
{-1,2,null,-1,4},
{-1,2,1,null,4},
{-1,2,2,null,5},
{-1,2,-1,null,4},
{-1,-1,null,null,2},
{-1,-1,null,null,2},
{-1,-1,null,null,2},
{-1,-1,0,null,2},
{-1,-1,null,null,2},
{-1,-1,null,0,2},
{-1,-1,null,null,2},
{-1,-1,null,null,2},
{-1,-1,null,1,3},
{-1,-1,null,2,4},
{-1,-1,null,-1,3},
{-1,-1,1,null,3},
{-1,-1,2,null,4},
{-1,-1,-1,null,3}};

        readonly int[,][] PointInfo = {{new int[]{0,1,2,32,49,66,83,124,165,206,268,330,392,400,407,427,438,449,454,458,468,472,482,486,498,502,503,509,510,511,512,513,516,517,520,521,524,528,531,532,539,542,543,550,553,554,560,561,565,569,570,571,574,575,579,583,584,585,588,589,593,597,598,599,601,604,606,629,630,640,641,651,652,664,678,692},
new int[]{1,3,4,5,33,50,67,83,84,85,100,108,116,124,125,126,141,149,157,165,166,167,182,190,198,207,269,331,392,400,401,402,411,415,419,425,436,447,454,458,459,462,463,464,468,472,473,476,477,478,482,486,487,490,491,492,499,506,507,511,512,515,519,523,531,532,542,543,553,554,559,563,564,566,567,568,573,577,578,580,581,582,587,591,592,594,595,596,605,606,609,612,614,618,622,626,631,633,634,637,638,639,642,644,645,648,649,650,653,655,656,659,660,661,664,669,678,683,692,697},
new int[]{1,4,6,83,84,124,125,165,166,208,270,332,392,393,394,409,413,417,421,432,443,454,468,482,496,504,511,531,542,553,558,562,572,576,586,590,602,606,607,613,614,615,616,617,620,621,624,625,628,632,635,636,643,646,647,654,657,658,664,665,669,673,674,675,678,679,683,687,688,689,692,693,697,701,702,703},
new int[]{1,4,7,34,51,68,85,86,90,93,95,98,99,100,101,104,108,109,112,116,117,120,130,137,140,144,147,152,155,160,163,166,171,172,185,193,201,248,249,262,310,311,324,372,373,386,393,396,423,427,428,429,430,431,439,444,497,500,527,531,532,533,534,535,543,548,601,604,631,635,636,637,638,639,647,652},
new int[]{1,4,8,9,35,52,69,86,88,91,92,93,101,104,109,112,117,120,128,135,138,139,140,143,146,148,151,154,156,159,162,164,171,174,178,179,185,188,189,193,196,197,201,204,205,209,247,257,258,259,260,264,265,266,267,271,309,319,320,321,322,326,327,328,329,333,371,381,382,383,384,388,389,390,391,393,396,399,424,425,426,438,439,448,457,465,471,479,485,493,497,500,503,528,529,530,542,543,552,561,569,575,583,589,597,601,604,607,632,633,634,646,647,656,665,673,679,687,693,701},
new int[]{4,10,11,36,53,70,83,84,86,101,109,117,126,127,131,134,136,139,140,141,142,145,149,150,153,157,158,161,171,178,181,185,188,193,196,201,204,210,255,256,272,317,318,334,379,380,396,421,422,434,438,439,440,441,442,450,500,525,526,538,542,543,544,545,546,554,604,629,630,642,646,647,648,649,650,658},
                                       },{new int[]{0,12,13,14,37,54,71,91,132,173,206,211,212,223,231,239,268,273,274,285,293,301,330,335,336,347,355,363,395,402,403,407,408,411,415,419,427,428,438,439,449,450,455,459,460,462,463,464,469,473,474,476,477,478,483,487,488,490,491,492,501,502,505,508,510,514,518,522,527,529,530,533,534,535,538,540,541,544,545,546,549,551,552,555,556,557,560,565,574,579,588,593,601,603,604,605,618,622,626,629,630,631,637,638,639,640,641,642,648,649,650,651,652,653,659,660,661,663,677,691},
new int[]{2,3,13,15,16,17,32,38,49,55,66,72,91,92,132,133,173,174,207,213,269,275,331,337,394,395,401,403,404,405,409,412,413,416,417,420,425,426,436,437,447,448,455,460,469,474,483,488,498,499,505,507,508,509,513,516,517,520,521,524,529,530,540,541,551,552,559,564,573,578,587,592,602,603,609,611,612,613,617,620,621,624,625,628,633,634,644,645,655,656,663,668,677,682,691,696},
new int[]{5,6,13,16,18,33,50,67,85,91,92,100,108,116,126,132,133,141,149,157,167,173,174,182,190,198,208,214,270,276,332,338,393,395,396,397,410,414,418,421,422,423,429,430,431,432,433,434,440,441,442,443,444,445,451,452,453,455,469,483,496,504,505,506,515,519,523,529,540,551,558,562,563,566,567,568,572,576,577,580,581,582,586,590,591,594,595,596,603,610,611,615,616,619,623,627,635,636,646,647,657,658,663,667,668,670,671,672,677,681,682,684,685,686,691,695,696,698,699,700},
new int[]{7,9,13,16,19,34,39,51,56,68,73,87,94,97,98,99,102,105,107,110,113,115,118,121,123,130,133,137,138,144,147,148,152,155,156,160,163,164,165,166,169,170,184,192,200,209,250,251,252,253,257,258,259,260,261,271,312,313,314,315,319,320,321,322,323,333,374,375,376,377,381,382,383,384,385,399,401,404,427,428,437,443,444,446,457,467,471,481,485,495,503,505,508,531,532,541,547,548,550,561,571,575,585,589,599,607,609,612,635,636,645,651,652,654,665,675,679,689,693,703},
new int[]{8,11,13,16,20,21,35,40,52,57,69,74,87,90,91,92,94,95,102,105,110,113,118,121,128,131,132,133,135,136,143,146,151,154,159,162,169,172,173,174,176,177,184,187,192,195,200,203,210,215,248,249,255,256,262,263,272,277,310,311,317,318,324,325,334,339,372,373,379,380,386,387,401,404,425,426,436,437,447,448,505,508,529,530,540,541,551,552,609,612,633,634,644,645,655,656},
new int[]{10,16,22,23,36,41,42,53,58,59,70,75,76,83,84,87,88,102,110,118,127,129,132,133,134,142,145,150,153,158,161,169,176,179,180,181,184,187,189,192,195,197,200,203,205,216,224,232,240,247,254,264,265,266,267,278,286,294,302,309,316,326,327,328,329,340,348,356,364,371,378,388,389,390,391,404,421,422,424,435,436,437,449,450,465,466,479,480,493,494,508,525,526,528,539,540,541,553,554,569,570,583,584,597,598,612,629,630,632,643,644,645,657,658,673,674,687,688,701,702},
},{new int[]{0,12,24,98,139,180,206,211,268,273,330,335,394,398,399,405,406,407,408,409,412,413,416,417,420,424,427,428,435,438,439,446,449,450,456,457,461,465,466,467,470,471,475,479,480,481,484,485,489,493,494,495,497,500,502,525,526,536,537,547,548,560,574,588,600,601,602,617,621,625,629,640,651,662,676,690},
new int[]{3,14,15,24,25,37,54,71,98,99,139,140,180,181,207,212,213,223,231,239,269,274,275,285,293,301,331,336,337,347,355,363,397,398,401,404,406,410,414,418,423,425,426,429,430,431,434,436,437,440,441,442,445,447,448,451,452,453,456,461,470,475,484,489,497,499,500,501,514,518,522,525,526,527,533,534,535,536,537,538,544,545,546,547,548,549,555,556,557,559,573,587,600,608,609,610,619,623,627,633,644,655,662,666,667,670,671,672,676,680,681,684,685,686,690,694,695,698,699,700},
new int[]{2,6,9,17,18,24,25,32,38,49,55,66,72,88,98,99,129,139,140,170,180,181,208,209,214,247,254,261,270,271,276,309,316,323,332,333,338,371,378,385,393,396,398,421,422,432,433,443,444,456,470,484,496,497,498,513,517,521,525,536,547,558,572,586,600,608,615,635,646,657,662,666,676,680,690,694},
new int[]{5,7,11,19,21,24,25,33,34,39,50,51,56,67,68,73,89,96,99,103,106,111,114,119,122,125,130,131,144,152,160,165,166,168,183,191,199,210,215,255,272,277,317,334,339,379,397,407,408,410,414,418,428,433,443,444,501,511,512,514,518,522,532,537,547,548,605,615,616,618,622,626,636,641,651,652},
new int[]{8,20,23,24,25,35,40,42,52,57,59,69,74,76,89,92,96,97,103,106,107,111,114,115,119,122,123,124,125,128,129,143,151,159,168,170,173,174,175,183,186,191,194,199,202,216,224,232,240,250,251,252,253,254,261,278,286,294,302,312,313,314,315,316,323,340,348,356,364,374,375,376,377,378,385,407,408,426,432,433,435,446,447,448,466,467,480,481,494,495,511,512,530,536,537,539,550,551,552,570,571,584,585,598,599,615,616,634,640,641,643,654,655,656,674,675,688,689,702,703},
new int[]{10,22,25,36,41,53,58,70,75,84,89,90,103,111,119,124,125,127,142,150,158,167,168,172,175,177,180,181,182,183,186,190,191,194,198,199,202,248,262,263,310,324,325,372,386,387,408,422,432,433,445,449,450,451,452,453,512,526,536,537,549,553,554,555,556,557,616,630,640,641,653,657,658,659,660,661},
},{new int[]{0,12,26,43,60,77,211,215,221,229,237,245,249,256,263,276,283,284,291,292,299,300,307,308,332,334,336,338,339,341,342,347,349,350,355,357,358,363,365,366,372,373,379,380,386,387,392,400,458,475,484,487,489,490,491,492,496,504,562,579,588,591,593,594,595,596,600,608,666,683,692,695,697,698,699,700},
new int[]{3,9,15,26,27,43,44,60,61,77,78,88,129,170,206,209,211,219,227,235,243,247,254,261,275,278,283,284,286,291,292,294,299,300,302,307,308,312,313,314,315,319,320,321,322,326,327,328,329,332,338,340,343,344,348,351,352,356,359,360,364,367,368,374,375,376,377,381,382,383,384,388,389,390,391,395,399,403,424,435,446,454,457,458,465,466,467,474,484,489,499,503,507,528,539,550,558,561,562,569,570,571,578,588,593,603,607,611,632,643,654,662,665,666,673,674,675,682,692,697},
new int[]{6,11,14,18,21,26,27,37,43,44,54,60,61,71,77,78,90,95,131,136,172,177,206,211,217,225,233,241,273,277,283,291,299,307,311,318,325,338,345,346,353,354,361,362,369,370,398,402,406,411,415,419,454,458,472,489,502,506,510,515,519,523,558,562,576,593,606,610,614,619,623,627,662,666,680,697},
new int[]{2,7,17,19,23,26,27,39,47,48,55,58,65,70,75,78,86,93,97,104,114,119,122,127,134,138,145,155,160,163,168,175,179,186,196,201,204,216,217,218,229,230,238,242,250,257,264,278,279,280,291,292,300,304,312,319,326,340,341,342,353,354,362,366,374,381,388,394,405,416,498,509,520,602,613,624},
new int[]{5,8,20,26,27,34,37,39,45,46,54,57,64,65,67,70,75,80,85,87,94,101,104,113,116,119,122,126,128,135,142,145,154,157,160,163,167,169,176,183,186,195,198,201,204,217,218,223,227,228,231,237,238,244,279,280,285,289,290,293,299,300,306,341,342,347,351,352,355,361,362,368,397,411,415,418,423,431,434,442,445,453,462,463,476,477,490,491,501,515,519,522,527,535,538,546,549,557,566,567,580,581,594,595,605,619,623,626,631,639,642,650,653,661,670,671,684,685,698,699},
new int[]{10,22,27,32,34,38,39,42,43,44,56,64,65,72,75,82,89,96,101,104,107,112,122,130,137,142,145,148,153,163,171,178,183,186,189,194,204,218,224,225,226,237,238,246,251,258,265,280,286,287,288,299,300,308,313,320,327,342,348,349,350,361,362,370,375,382,389,409,412,420,513,516,524,617,620,628},
},{new int[]{0,9,12,28,45,62,79,88,129,170,213,216,221,222,224,229,230,232,237,238,240,245,246,250,251,252,253,257,258,259,260,264,265,266,267,270,276,278,281,282,286,289,290,294,297,298,302,305,306,312,313,314,315,319,320,321,322,326,327,328,329,331,333,337,341,342,349,350,357,358,365,366,371,378,385,392,399,400,424,435,446,460,470,475,483,485,488,493,494,495,496,503,504,528,539,550,564,574,579,587,589,592,597,598,599,600,607,608,632,643,654,668,678,683,691,693,696,701,702,703},
new int[]{3,11,15,21,28,29,45,46,62,63,79,80,90,95,131,136,172,177,207,210,213,215,219,220,227,228,235,236,243,244,248,249,255,256,262,263,269,272,275,277,281,282,289,290,297,298,305,306,310,311,317,318,324,325,331,334,337,339,343,344,351,352,359,360,367,368,372,373,379,380,386,387,395,403,455,460,469,474,483,488,499,507,559,564,573,578,587,592,603,611,663,668,677,682,691,696},
new int[]{6,18,23,28,29,42,45,46,59,62,63,76,79,80,97,107,115,123,138,148,156,164,179,189,197,205,207,209,213,217,218,225,226,233,234,241,242,247,254,261,268,271,273,281,289,297,305,309,316,323,337,340,345,346,348,353,354,356,361,362,364,369,370,374,375,376,377,381,382,383,384,388,389,390,391,398,406,455,457,460,465,466,467,468,471,472,479,480,481,488,502,510,559,561,564,569,570,571,572,575,576,583,584,585,592,606,614,663,665,668,673,674,675,676,679,680,687,688,689,696},
new int[]{7,14,19,28,29,37,40,47,48,50,53,58,63,67,69,74,77,78,86,93,105,108,111,114,116,118,121,127,134,146,149,152,155,157,159,162,168,175,187,190,193,196,198,200,203,212,219,220,223,229,230,236,241,242,274,281,282,285,291,292,298,303,304,336,343,344,347,353,354,360,365,366,402,411,414,418,430,431,441,442,452,453,459,462,473,476,487,490,506,515,518,522,534,535,545,546,556,557,563,566,577,580,591,594,610,619,622,626,638,639,649,650,660,661,667,670,681,684,695,698},
new int[]{2,8,17,20,28,29,32,35,38,40,45,46,49,52,55,57,62,63,66,69,72,74,79,80,87,94,102,105,110,113,118,121,128,135,143,146,151,154,159,162,169,176,184,187,192,195,200,203,219,220,227,228,235,236,243,244,281,282,289,290,297,298,305,306,343,344,351,352,359,360,367,368,394,405,409,412,413,416,417,420,498,509,513,516,517,520,521,524,602,613,617,620,621,624,625,628},
new int[]{5,10,22,29,33,35,40,43,44,51,54,56,62,63,71,74,81,82,85,89,96,100,102,105,109,112,121,126,130,137,141,143,146,150,153,162,167,171,178,182,184,187,191,194,203,220,225,226,231,235,236,239,245,246,282,287,288,293,297,298,301,307,308,344,349,350,355,359,360,363,369,370,397,410,415,419,423,429,434,440,445,451,463,464,477,478,491,492,501,514,519,523,527,533,538,544,549,555,567,568,581,582,595,596,605,618,623,627,631,637,642,648,653,659,671,672,685,686,699,700},
},{new int[]{12,21,30,47,64,81,95,136,177,214,221,222,229,230,237,238,245,246,270,272,274,276,277,279,280,285,287,288,293,295,296,301,303,304,310,311,317,318,324,325,330,335,341,349,357,365,400,461,470,473,475,476,477,478,482,486,504,565,574,577,579,580,581,582,586,590,608,669,678,681,683,684,685,686,690,694},
new int[]{15,23,30,31,42,47,48,59,64,65,76,81,82,97,107,115,123,138,148,156,164,179,189,197,205,208,214,216,219,220,224,227,228,232,235,236,240,243,244,250,251,252,253,257,258,259,260,264,265,266,267,269,271,275,279,280,287,288,295,296,303,304,309,316,323,330,333,335,343,351,359,367,371,378,385,403,456,461,469,471,474,479,480,481,482,485,486,493,494,495,507,560,565,573,575,578,583,584,585,586,589,590,597,598,599,611,664,669,677,679,682,687,688,689,690,693,694,701,702,703},
new int[]{18,30,31,47,48,64,65,81,82,208,210,212,214,215,217,218,223,225,226,231,233,234,239,241,242,248,249,255,256,262,263,268,273,279,287,295,303,335,339,345,353,361,369,373,380,387,406,456,459,461,462,463,464,468,472,486,510,560,563,565,566,567,568,572,576,590,614,664,667,669,670,671,672,676,680,694},
new int[]{19,30,31,38,41,48,53,58,61,66,68,72,73,76,77,78,93,106,111,114,117,120,123,134,147,152,155,158,161,164,175,188,193,196,199,202,205,221,222,230,234,240,241,242,253,260,267,283,284,292,296,302,303,304,315,322,329,345,346,354,358,364,365,366,377,384,391,412,417,420,516,521,524,620,625,628},
new int[]{14,20,30,31,33,36,41,46,50,52,57,60,61,68,71,73,79,80,94,100,103,106,108,110,113,117,120,135,141,144,147,149,151,154,158,161,176,182,185,188,190,192,195,199,202,212,221,222,228,233,234,239,243,244,274,283,284,290,295,296,301,305,306,336,345,346,352,357,358,363,367,368,402,410,414,419,429,430,440,441,451,452,459,464,473,478,487,492,506,514,518,523,533,534,544,545,555,556,563,568,577,582,591,596,610,618,622,627,637,638,648,649,659,660,667,672,681,686,695,700},
new int[]{17,22,31,36,41,44,49,51,55,56,59,60,61,73,81,82,96,103,106,109,112,115,120,137,144,147,150,153,156,161,178,185,188,191,194,197,202,222,226,232,233,234,245,246,252,259,266,284,288,294,295,296,307,308,314,321,328,346,350,356,357,358,369,370,376,383,390,405,413,416,509,517,520,613,621,624}}};

        readonly int[][] secInfo = {new int[]{0,1,2,3,4,5,6,9,12,13,14,15,16,17,18,24,25,32,33,37,38,49,50,54,55,66,67,71,72,83,84,85,88,91,92,98,99,100,108,116,124,125,126,129,132,133,139,140,141,149,157,165,166,167,170,173,174,180,181,182,190,198,206,207,208,209,211,212,213,214,223,231,239,247,254,261,268,269,270,271,273,274,275,276,285,293,301,309,316,323,330,331,332,333,335,336,337,338,347,355,363,371,378,385,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703},
new int[]{0,3,6,9,11,12,14,15,18,21,23,26,27,28,29,30,31,37,42,43,44,45,46,47,48,54,59,60,61,62,63,64,65,71,76,77,78,79,80,81,82,88,90,95,97,107,115,123,129,131,136,138,148,156,164,170,172,177,179,189,197,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,395,398,399,400,402,403,406,411,415,419,424,435,446,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,499,502,503,504,506,507,510,515,519,523,528,539,550,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,603,606,607,608,610,611,614,619,623,627,632,643,654,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703},
new int[]{1,4,5,7,8,9,10,11,13,16,19,20,21,22,23,24,25,33,34,35,36,39,40,41,42,50,51,52,53,56,57,58,59,67,68,69,70,73,74,75,76,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,209,210,215,216,224,232,240,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,271,272,277,278,286,294,302,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,333,334,339,340,348,356,364,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,393,396,397,399,401,404,407,408,410,414,418,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,457,465,466,467,471,479,480,481,485,493,494,495,497,500,501,503,505,508,511,512,514,518,522,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,561,569,570,571,575,583,584,585,589,597,598,599,601,604,605,607,609,612,615,616,618,622,626,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,665,673,674,675,679,687,688,689,693,701,702,703},
new int[]{2,5,7,8,10,14,17,19,20,22,23,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,85,86,87,89,93,94,96,97,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,126,127,128,130,134,135,137,138,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,167,168,169,171,175,176,178,179,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,212,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,250,251,252,253,257,258,259,260,264,265,266,267,274,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,312,313,314,315,319,320,321,322,326,327,328,329,336,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,374,375,376,377,381,382,383,384,388,389,390,391,394,397,402,405,409,410,411,412,413,414,415,416,417,418,419,420,423,429,430,431,434,440,441,442,445,451,452,453,459,462,463,464,473,476,477,478,487,490,491,492,498,501,506,509,513,514,515,516,517,518,519,520,521,522,523,524,527,533,534,535,538,544,545,546,549,555,556,557,563,566,567,568,577,580,581,582,591,594,595,596,602,605,610,613,617,618,619,620,621,622,623,624,625,626,627,628,631,637,638,639,642,648,649,650,653,659,660,661,667,670,671,672,681,684,685,686,695,698,699,700}};

        protected readonly int[] Values = { 0, 1, 4, 16, 64, 256 };

         public PentagoNodeEva2(PentagoBoard currentState, Status currentTurn, int maxDepth)
            : base(currentState, currentTurn, maxDepth)
        {
        }

         public PentagoNodeEva2(PentagoBoard currentState, PentagoNode parent)
            : base(currentState, parent)
        {
        }

         public AbstractTreeNode[] Expand()
         {
             LinkedList<PentagoNodeEva2> result = new LinkedList<PentagoNodeEva2>();
             for (int i = 0; i < currentState.TotalWidth; i++)
                 for (int j = 0; j < currentState.TotalHeight; j++)
                 {
                     if (currentState[i, j].State == Status.StateEnum.empty)
                     {
                         for (int k = 0; k < currentState.Sections.Count; k++)
                         {
                             result.AddLast(new PentagoNodeEva2(currentState, this)
                             {
                                 PlaceX = i,
                                 PlaceY = j,
                                 SectionNo = k,
                                 Clockwise = true,
                             });
                             //if the board state remains the same after rotating clockwise, it will be the same after rotating counterclockwise
                             //so the node can be eliminated
                             if (!currentState.Sections[k].IsSameInBothDirection)
                             {
                                 result.AddLast(new PentagoNodeEva2(currentState, this)
                                 {
                                     PlaceX = i,
                                     PlaceY = j,
                                     SectionNo = k,
                                     Clockwise = false,
                                 });
                             }
                         }
                     }
                 }
             return result.ToArray();
         }

         public override int EvaluateCurrent(object info)
         {
             var player = info as Status;
             int totalValue = 0;
             int[,] piecesInLine = new int[RotationInfo.GetLength(0), 2];
             for (int i = 0; i < currentState.TotalWidth; i++)
                 for (int j = 0; j < currentState.TotalHeight; j++)
                 {
                     if (currentState[i, j].State == player.State)
                     {
                         for (int k = 0; k < this.PointInfo[i, j].Length; k++)
                         {
                             piecesInLine[PointInfo[i, j][k], 0]++;
                         }
                     }
                     else if (currentState[i, j].State != Status.StateEnum.empty)
                     {
                         for (int k = 0; k < PointInfo[i, j].Length; k++)
                         {
                             piecesInLine[PointInfo[i, j][k], 1]++;
                         }
                     }
                 }
             for (int i = 0; i < piecesInLine.GetLength(0); i++)
             {
                 int ourPieces = piecesInLine[i, 0];
                 int theirPieces = piecesInLine[i, 1];
                 //if (ourPieces > 3 || theirPieces > 3)
                 //Debug.WriteLine(i + ":" + ourPieces + "," + theirPieces);
                 if (ourPieces == 0)
                     totalValue -= Values[Math.Min(theirPieces, 5-(int)RotationInfo[i, 4])];
                 else if (theirPieces == 0)
                     totalValue += Values[Math.Min(ourPieces, 5- (int)RotationInfo[i, 4])];
             }
             Value = totalValue;
             return totalValue;
         }
    }
}
